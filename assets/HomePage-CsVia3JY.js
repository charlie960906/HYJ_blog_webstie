const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RelatedPosts-CAJKxOLe.js","assets/index-CAM6mz7D.js","assets/index-DoOnSiyO.css"])))=>i.map(i=>d[i]);
import{c as R,r,_ as M,j as e,L as v,C as B,u as $,a as z,b as D,g as F,d as U,f as q,t as G}from"./index-CAM6mz7D.js";import{T as _}from"./tag-BGfrjGdV.js";import{C as O}from"./calendar-Clm53gwm.js";import{g as V}from"./tags-DpYjne1T.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=R("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=R("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=R("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=R("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),K=r.lazy(()=>M(()=>import("./RelatedPosts-CAJKxOLe.js"),__vite__mapDeps([0,1,2]))),X=({post:a,isLazy:f=!1})=>{const m=()=>{typeof gtag<"u"&&gtag("event","click",{event_category:"engagement",event_label:"read_more",value:a.slug})},p=o=>new Date(o).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"}),b=o=>{const g=o.split(" ").length;return Math.ceil(g/200)};return e.jsx("article",{className:"post-card-container glassmorphism-card p-4 sm:p-6 hover:scale-105 transition-all duration-300 group",children:e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"post-card-tags flex flex-wrap gap-1 sm:gap-2",children:[a.tags.slice(0,4).map(o=>e.jsxs("span",{className:"post-card-tag inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-100 border border-blue-400/30",children:[e.jsx(_,{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 mr-1"}),o]},o)),a.tags.length>4&&e.jsxs("span",{className:"post-card-tag inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs font-medium bg-gray-500/20 text-gray-100 border border-gray-400/30",children:["+",a.tags.length-4]})]}),e.jsx("h2",{className:"post-card-title text-xl sm:text-2xl font-bold text-white group-hover:text-blue-300 transition-colors duration-200 leading-tight",children:e.jsx(v,{to:`/post/${a.slug}`,children:a.title})}),e.jsxs("div",{className:"post-card-meta flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-2 sm:space-y-0 text-sm text-white/70",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"text-xs sm:text-sm",children:p(a.date)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),e.jsxs("span",{className:"text-xs sm:text-sm",children:[b(a.content)," 分鐘閱讀"]})]})]}),e.jsx("p",{className:"text-white/80 line-clamp-3 leading-relaxed text-sm sm:text-base",children:a.summary}),e.jsx("div",{className:"flex justify-between items-center pt-3 sm:pt-4",children:e.jsxs(v,{to:`/post/${a.slug}`,onClick:m,className:"inline-flex items-center px-3 sm:px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-full hover:from-blue-600 hover:to-purple-600 transition-all duration-200 group/btn text-sm sm:text-base",children:["閱讀更多",e.jsx(W,{className:"w-3 h-3 sm:w-4 sm:h-4 ml-2 group-hover/btn:translate-x-1 transition-transform"})]})}),f&&e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"animate-pulse bg-white/10 h-20 sm:h-24 rounded-lg"}),children:e.jsx(K,{currentPost:a})})]})})},Z=()=>{const[a,f]=r.useState([]),[m,p]=r.useState(!0),[b,o]=r.useState(null);return r.useEffect(()=>{(async()=>{try{p(!0);const g=await V(),i=["bg-red-500/20 text-red-100 border-red-400/30","bg-cyan-500/20 text-cyan-100 border-cyan-400/30","bg-blue-500/20 text-blue-100 border-blue-400/30","bg-green-500/20 text-green-100 border-green-400/30","bg-yellow-500/20 text-yellow-100 border-yellow-400/30","bg-purple-500/20 text-purple-100 border-purple-400/30","bg-teal-500/20 text-teal-100 border-teal-400/30","bg-indigo-500/20 text-indigo-100 border-indigo-400/30","bg-pink-500/20 text-pink-100 border-pink-400/30","bg-sky-500/20 text-sky-100 border-sky-400/30","bg-emerald-500/20 text-emerald-100 border-emerald-400/30","bg-orange-500/20 text-orange-100 border-orange-400/30","bg-lime-500/20 text-lime-100 border-lime-400/30","bg-violet-500/20 text-violet-100 border-violet-400/30","bg-rose-500/20 text-rose-100 border-rose-400/30","bg-gray-500/20 text-gray-100 border-gray-400/30","bg-blue-600/20 text-blue-100 border-blue-500/30","bg-green-600/20 text-green-100 border-green-500/30","bg-purple-600/20 text-purple-100 border-purple-500/30","bg-teal-600/20 text-teal-100 border-teal-500/30"],y=g.filter(n=>n.name&&typeof n.count=="number"&&typeof n.size=="number").map((n,h)=>({...n,color:i[h%i.length]})).sort((n,h)=>h.count-n.count||n.name.localeCompare(h.name));f(y)}catch(g){o("載入標籤失敗，請稍後再試"),console.error("Failed to load tags:",g)}finally{p(!1)}})()},[]),e.jsxs("aside",{className:"space-y-6",children:[e.jsxs("div",{className:"glassmorphism-card p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Q,{className:"w-5 h-5 text-blue-400 mr-2"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"關於我"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("img",{src:"images/my.jpg",alt:"HYJ's Image",className:"w-20 h-20 sm:w-24 sm:h-24 lg:w-32 lg:h-32 rounded-full mx-auto mb-3 sm:mb-4 object-cover sidebar-about-image"}),e.jsx("p",{className:"text-white text-base sm:text-lg font-bold text-center mb-2",children:"老黃"}),e.jsx("p",{className:"text-white/80 text-xs sm:text-sm text-center leading-relaxed",children:"目前主要興趣在於演算法、人工智慧、財經投資等～"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{to:"/about",className:"text-blue-400 hover:text-blue-300 text-xs sm:text-sm font-medium transition-colors",children:"了解更多 →"})})]})]}),e.jsxs("div",{className:"glassmorphism-card p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(_,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400 mr-2"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-white",children:"標籤雲"})]}),e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:m?e.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"載入中..."}):b?e.jsx("p",{className:"text-red-400 text-xs sm:text-sm",children:b}):a.length>0?a.slice(0,12).map(l=>e.jsxs(v,{to:`/?tag=${encodeURIComponent(l.name)}`,className:`inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs font-medium border transition-all duration-200 hover:scale-105 ${l.color||"bg-gray-500/20 text-gray-100 border-gray-400/30"}`,children:[l.name," (",l.count,")"]},l.name)):e.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"暫無標籤"})}),e.jsx("div",{className:"mt-3 sm:mt-4 text-center",children:e.jsx(v,{to:"/tags",className:"text-blue-400 hover:text-blue-300 text-xs sm:text-sm font-medium transition-colors",children:"查看所有標籤 →"})})]})]})},T=6,re=()=>{const[a,f]=r.useState([]),[m,p]=r.useState([]),[b,o]=r.useState(!0),[l,g]=$(),{category:i}=z(),y=r.useRef(null),n=r.useRef(null),h=r.useRef(null),u=l.get("search"),P=l.get("tag"),c=parseInt(l.get("page")||"1",10);r.useEffect(()=>{(async()=>{try{o(!0);let s;i?s=await F(i):s=await U(),f(s);const w=q(s,{search:u,tag:P});p(w),u&&G(u,w.length)}catch(s){console.error("載入文章失敗:",s)}finally{o(!1)}})()},[u,P,i]),r.useEffect(()=>{let t;const s=()=>{clearTimeout(t),t=setTimeout(()=>{if(!y.current||!n.current||!h.current)return;const w=n.current,x=h.current,d=y.current,C=w.getBoundingClientRect().bottom,N=x.getBoundingClientRect().top,L=window.innerHeight;C<=L&&N>L?(d.style.position="absolute",d.style.bottom="0",d.style.top="auto"):(d.style.position="sticky",d.style.top="5rem",d.style.bottom="auto")},50)};return window.addEventListener("scroll",s),()=>{window.removeEventListener("scroll",s),clearTimeout(t)}},[]);const j=Math.ceil(m.length/T),S=(c-1)*T,I=S+T,E=m.slice(S,I);r.useEffect(()=>{if(n.current){const t=n.current.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:t-96,behavior:"smooth"})}},[c]);const k=t=>{if(t<1||t>j)return;const s=new URLSearchParams(l);s.set("page",t.toString()),g(s)},A=t=>({information:"資訊文章",reviews:"評測",finance:"財經",travel:"旅行",life:"生活"})[t]||t,H=(t,s)=>{const x=[],d=Math.max(2,t-1),C=Math.min(s-1,t+1);x.push(1),d>2&&x.push("...");for(let N=d;N<=C;N++)x.push(N);return C<s-1&&x.push("..."),s>1&&x.push(s),x};return b?e.jsx(D,{}):e.jsx("div",{className:"container mx-auto px-4 py-6 sm:py-8",style:{paddingTop:i?"5rem":"1.5rem"},children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 homepage-grid",children:[e.jsxs("div",{className:"order-1 lg:order-none lg:col-span-2 main-content scroll-mt-24",ref:n,children:[i&&e.jsxs("div",{className:"glassmorphism-card p-4 sm:p-6 mb-6 sm:mb-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-2",children:A(i)}),e.jsxs("p",{className:"text-sm sm:text-base text-white/80",children:["共 ",m.length," 篇文章"]})]}),u&&e.jsx("div",{className:"glassmorphism-card p-3 sm:p-4 mb-6 sm:mb-8",children:e.jsxs("p",{className:"text-sm sm:text-base text-white/80",children:['搜尋 "',u,'" 的結果：',m.length," 篇文章"]})}),P&&e.jsx("div",{className:"glassmorphism-card p-3 sm:p-4 mb-6 sm:mb-8",children:e.jsxs("p",{className:"text-sm sm:text-base text-white/80",children:['標籤 "',P,'" 的文章：',m.length," 篇"]})}),e.jsx("div",{className:"space-y-6 sm:space-y-8",children:E.length===0?e.jsxs("div",{className:"glassmorphism-card p-6 sm:p-8 text-center",children:[e.jsx("p",{className:"text-white/80 text-base sm:text-lg",children:"沒有找到相關文章"}),(u||i)&&e.jsx("p",{className:"text-white/60 text-xs sm:text-sm mt-2",children:"嘗試調整搜尋條件或瀏覽所有文章"})]}):E.map((t,s)=>e.jsx(X,{post:t,isLazy:s>2},t.slug))}),j>1&&e.jsxs("div",{className:"pagination-container mt-6 sm:mt-8",children:[e.jsx("button",{onClick:()=>k(c-1),disabled:c===1,className:`pagination-button p-2 sm:p-3 rounded-full transition-colors ${c===1?"bg-gray-600 text-white/50 cursor-not-allowed opacity-50":"inactive"}`,"aria-label":"上一頁",children:e.jsx(Y,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),H(c,j).map((t,s)=>t==="..."?e.jsx("span",{className:"px-1 sm:px-2 text-white/50 text-sm",children:"..."},s):e.jsx("button",{onClick:()=>k(Number(t)),className:`pagination-button px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-colors ${c===t?"active":"inactive"}`,children:t},t)),e.jsx("button",{onClick:()=>k(c+1),disabled:c===j,className:`pagination-button p-2 sm:p-3 rounded-full transition-colors ${c===j?"bg-gray-600 text-white/50 cursor-not-allowed opacity-50":"inactive"}`,"aria-label":"下一頁",children:e.jsx(J,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsx("div",{className:"order-2 lg:order-none lg:col-span-1 sidebar-container sidebar-mobile",children:e.jsx("div",{className:"sidebar-content",ref:y,children:e.jsx(Z,{})})})]})})};export{re as default};
